var mostVisited={showCount:8,show:function(){var a=1000*60*60*24*14;var b=(new Date).getTime()-a;chrome.history.search({text:"",startTime:b},function(e){var k={};for(g=0;g<e.length;g++){if(k[e[g].visitCount]==undefined){k[e[g].visitCount]=new Array()}k[e[g].visitCount].push({url:e[g].url})}var d=new Array();for(var h in k){d.unshift({count:h,contents:k[h]})}var c=new Array();for(var g=0;g<d.length;g++){if(c.length+d[g]["contents"].length<mostVisited.showCount+1){c=c.concat(d[g]["contents"])}else{for(var f=0;f<mostVisited.showCount-c.length;f++){c.push(d[g]["contents"][f])}}}for(var g=0;g<c.length;g++){$("#mv_content").append('<a class="mv clearfix" href="'+c[g].url+'" title="'+c[g].url+'"><img width="16" height="16" class="favicon" src="chrome://favicon/'+c[g].url+'" /><p>'+mostVisited.getDomain(c[g].url)+"</p></a>")}$("#mv_content").masonry({isAnimated:true,animationOptions:{duration:500,easing:"linear",queue:false},isFitWidth:true});$(".mv").hover(function(){$(this).css("border","1px solid #ccc")},function(){$(this).css("border","none")});$("#most_visited .title").toggle(function(){$(this).next().slideUp("fast");localStorage[$(this).parent().attr("id")]="close";$(this).children("img").attr("src","img/arrow_right.png")},function(){$(this).next().slideDown("fast");$("#mv_content").masonry("destroy");$("#mv_content").masonry({isAnimated:true,animationOptions:{duration:500,easing:"linear",queue:false},isFitWidth:true});localStorage[$(this).parent().attr("id")]="";$(this).children("img").attr("src","img/arrow_down.png")});if(localStorage.most_visited=="close"){$("#mv_content").css("display","none");$("#most_visited .title img").attr("src","img/arrow_right.png");$("#most_visited .title").trigger("click")}else{$("#most_visited .title img").attr("src","img/arrow_down.png")}})},getDomain:function(a){if(a==undefined||a==""){return""}if(a.indexOf("http://")!=-1){a=a.substring(7,a.length)}if(a.indexOf("https://")!=-1){a=a.substring(8,a.length)}if(a.indexOf("/")!=-1){a=a.substring(0,a.indexOf("/"))}if(a.indexOf("www.")!=-1){a=a.substring(4,a.length)}if(a.length>15){a=a.substring(0,14)+".."}return a.charAt(0).toUpperCase()+a.slice(1)}};